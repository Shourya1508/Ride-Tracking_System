package com.example.ride.Kafkaconsumer;


import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Service;

import com.example.ride.Service.DriverTrackingService;


@Service
public class DriverLocationConsumer {

    private final DriverTrackingService trackingService;

    public DriverLocationConsumer(DriverTrackingService trackingService) {
        this.trackingService = trackingService;
    }

    @KafkaListener(topics = "driver-location", groupId = "ride-service")
    public void consume(String message) {
    	
        String[] data = message.split(":");
        Long driverId = Long.parseLong(data[0]);
        Double lat = Double.parseDouble(data[1]);
        Double lon = Double.parseDouble(data[2]);
        System.out.println("ðŸ“¥ Kafka Consumed: " + message);

        trackingService.updateLocation(driverId, lat, lon);
    }
}
